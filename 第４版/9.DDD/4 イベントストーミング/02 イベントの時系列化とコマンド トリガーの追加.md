# 02 イベントの時系列化とコマンド/トリガーの追加

## ステップ２：イベントの時系列化とコマンド/トリガーの追加 ⏳➡️🎬

Step 1 で主要なドメインイベントとして `[会議室が予約された]` を特定しました。このステップでは、このイベントが**いつ**、そして**何によって**引き起こされるのかを考え、時系列に配置します。

---

## ⏳ イベントを時間軸に置く

まずは、特定したイベントを（仮の）時間軸上に置きます。

```
-------------------------------------------------------> 時間
                        [会議室が予約された]

```

---

## 🎬 イベントの原因を探る：コマンド

イベントは「過去に起こった出来事」です。では、その出来事を引き起こした「**直接的な原因**」は何でしょうか？ 多くの場合、それはユーザー（アクター）や他のシステムからの**操作要求**、すなわち**コマンド (Command)** です。

- **イベント**: `[会議室が予約された]` (過去形)
- **コマンド**: `{会議室を予約する (Book Room)}` (命令形)

コマンドは、「システムに**何をしてほしいか**」という意図を表します。

---

## 🧑‍💻 コマンドを実行するのは誰？：アクター

では、その `{会議室を予約する}` コマンドは**誰が**実行するのでしょうか？ Step 1 で洗い出した候補から考えると、「利用者 / 予約者 (User)」が実行すると考えられます。これを**アクター (Actor)** と呼びます。

---

### ⛓️ イベントまでの流れを繋げる

これで、「アクター」が「コマンド」を実行し、その結果として「イベント」が発生する、という基本的な流れが見えてきました。

```
(利用者) -- {会議室を予約する} --> [会議室が予約された]

```

**読み方**:

1. `(利用者)` が
2. `{会議室を予約する}` という操作（コマンド）をシステムに対して行い、
3. その結果（成功した場合）、
4. `[会議室が予約された]` という出来事（イベント）が発生した。

---

### 📋 コマンドに必要な情報（パラメータ）

`{会議室を予約する}` コマンドを実行するためには、具体的にどのような情報が必要でしょうか？

- どの **会議室 (`RoomID`)** を予約したいか？
- **誰 (`UserID`)** が予約したいか？
- **いつ (`TimeRange`)** 予約したいか？

これらの情報は、コマンド (`{会議室を予約する}`) にパラメータとして渡される必要があります。

```
                             +-----------------------+
                             | RoomID, UserID, TimeRange |
                             +-----------|-----------+
                                         v
(利用者) -- {会議室を予約する} --> [会議室が予約された]

```

---

## 📝 まとめ

このステップでは、主要なドメインイベント `[会議室が予約された]` の**直接的な原因**として、アクター `(利用者)` が実行する**コマンド** `{会議室を予約する}` を特定しました。

イベント（過去）とその原因（コマンド/アクター）を時系列で繋げることで、システムの基本的なインタラクションの流れが見えてきました。また、コマンドに必要な情報（パラメータ）も明確になりました。

---

## ➡️ 次へ

次は、「**(Step 3) 集約/Read Modelの発見**」に進み、このコマンドが「どのモノ（集約）」に対して実行されるのか、また、コマンド実行前に参照される情報（Read Model）は何か、を考えてみましょう。
# 05 モデルへの反映と考察

## ステップ５：モデルへの反映と考察 🤔💡

これまでのステップで、会議室予約プロセスに関するイベント、コマンド、アクター、集約、Read Model、ポリシー、外部システムの関係性を洗い出し、視覚化（またはテキストフロー化）しました。

この最後のステップでは、イベントストーミングの結果が、実際のDDDのモデル（特に戦術的パターン）の設計にどのように役立つかを考察し、今回の演習から得られた学びをまとめます。

---

## 🤔 イベントストーミングの結果はどう役立つ？

イベントストーミングは、単なるプロセスの可視化にとどまらず、ドメインモデルの設計に直接的なヒントを与えてくれます。

1. **ドメインイベントの特定**:
    - 洗い出した `[会議室が予約された]` や `[予約がキャンセルされた]` といったイベントは、そのままDDDの**ドメインイベント**クラスの候補となります。これらのイベントは、システム内の状態変化を明確に表現し、副作用（ポリシー）を疎結合に連携させる基盤となります。
2. **コマンドの特定**:
    - イベントの原因として特定した `{会議室を予約する}` や `{予約をキャンセルする}` といったコマンドは、**UseCase**（またはApplication Service）が受け取るべき操作要求のインターフェース設計に繋がります。コマンドに必要なパラメータ（`RoomID`, `UserID`, `TimeRange`）も明確になりました。
3. **集約の特定**:
    - コマンドが操作する対象として特定した `<Reservation>` は、そのまま**集約ルート**の候補です。イベントストーミングを通じて、どのコマンドがどの集約の状態を変更するのか（あるいは生成するのか）が明確になります。
4. **Read Model / 参照の特定**:
    - コマンド実行前に参照される `{{会議室情報}}` や `{{既存予約情報}}` は、UseCase がどの**リポジトリ**に問い合わせる必要があるか、あるいは専用の**クエリサービス**や**Read Model**が必要か、といった設計のヒントを与えます。
5. **ポリシーと副作用**:
    - イベントによって引き起こされるポリシー（例：「予約されたら通知を送る」）は、**イベントハンドラ**や**ドメインサービス**が実装すべき副作用のロジックを示唆します。また、`<<通知システム>>` のような**外部システム**との連携点（Adapterが必要な箇所）も明確になります。
6. **境界の発見**:
    - （今回は単一コンテキストでしたが）もしイベントストーミング中に、ある場所で言葉の意味が変わったり、プロセスの担当者が明確に分かれたりする点が見つかれば、そこが**境界づけられたコンテキスト**の境界である可能性が高いです。

---

## ✨ この演習（簡易版）からの学び

たとえ一人で行う簡易版であっても、イベントストーミングのプロセスは以下のような学びをもたらします。

- **プロセスの全体像把握**: コードを書き始める前に、ビジネスプロセス全体の流れと関係性を俯瞰的に理解できます。
- **ドメイン言語の重視**: 「出来事（イベント）」を中心に考えることで、自然とドメイン（ビジネス）の言葉（ユビキタス言語）でシステムを捉える訓練になります。
- **重要な概念の発見**: プロセスを通じて、核となる集約、重要なイベント、必要なコマンドなどが自然と浮かび上がってきます。
- **隠れたルールの発見**: 「もし〜なら、〜する」というポリシーを考えることで、暗黙的だったビジネスルールや副作用が明確になります。
- **コミュニケーションの土台**: （本来の複数人での実施では）参加者全員がプロセスに対する共通理解を築くための強力なツールとなります。

---

## 📝 まとめ

イベントストーミングは、ドメインの**動的な側面（プロセス、流れ、出来事）**を理解し、それをDDDのモデル（特にイベント、コマンド、集約）に繋げるための効果的な手法です。

今回は簡易版でしたが、この思考プロセスを経ることで、よりドメインの実態に即した、堅牢で柔軟なソフトウェア設計を行うための重要な洞察を得ることができます。

---

## ✅ ドメインモデリング演習 (イベントストーミング) 完了！

これで、「イベントストーミング演習（簡易版）」は完了です。

---

## ➡️ 次へ

DDDの実践として、「ドメインモデリング演習（題材選択式）」、「既存コードのリファクタリング」、「イベントストーミング演習」を行いました。
次は、これらの実践を踏まえて、DDDの理論（特に戦略的設計）を改めて深く学ぶか、あるいはCQRSのような応用的なアーキテクチャパターンに進むか、といった選択肢が考えられます。どちらに進みますか？
# SOA-04

```markdown
## `interface_adapters/inventory_service_adapter.py`

å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®ã€Œå¥‘ç´„æ›¸ã€ã‚’å®šç¾©ã—ãŸæ¬¡ã¯ã€ãã®å¥‘ç´„æ›¸ã‚’å…·ä½“çš„ã«å±¥è¡Œã™ã‚‹ãŸã‚ã®éƒ¨å“ã€**`interface_adapters/inventory_service_adapter.py`**ã«é€²ã¿ã¾ã™ã€‚

---

### 1. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²ï¼šå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ã€Œå¤‰æ›ãƒ—ãƒ©ã‚°ã€

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€Interface Adaptersï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ï¼‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å±ã—ã¾ã™ã€‚ãã®åã®é€šã‚Šã€ã¾ã•ã«ã€Œã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã€ã¨ã—ã¦ã®å½¹å‰²ã‚’æ‹…ã„ã¾ã™ã€‚

Use Casesãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå®šç¾©ã—ãŸ`InventoryServicePort`ã¨ã„ã†æˆ‘ã€…ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…éƒ¨ã®ã€Œã‚³ãƒ³ã‚»ãƒ³ãƒˆã®å½¢ã€ã¨ã€`external_services`ãŒæä¾›ã™ã‚‹`InventoryService`ã¨ã„ã†å¤–éƒ¨ã®ã€Œç‰¹æ®Šãªå½¢çŠ¶ã®ãƒ—ãƒ©ã‚°ã€ã‚’ã€ã†ã¾ãé©åˆã•ã›ã‚‹ãŸã‚ã®å¤‰æ›ãƒ—ãƒ©ã‚°ã ã¨è€ƒãˆã¦ãã ã•ã„ã€‚

ã“ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ãŠã‹ã’ã§ã€Use Caseã¯æ¥ç¶šå…ˆãŒã©ã‚“ãªå½¢ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã£ã¦ã‚‚ã€å¸¸ã«æ¨™æº–çš„ãªã‚³ãƒ³ã‚»ãƒ³ãƒˆï¼ˆãƒãƒ¼ãƒˆï¼‰ã«æ¥ç¶šã™ã‚‹ã ã‘ã§æ¸ˆã‚€ã®ã§ã™ã€‚

### 2. ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®è©³ç´°è§£èª¬

`InventoryServiceAdapter(InventoryServicePort)`: å¥‘ç´„ã®å±¥è¡Œ
ã“ã®ã‚¯ãƒ©ã‚¹ã¯ã€`use_cases/interfaces.py`ã§å®šç¾©ã•ã‚ŒãŸ`InventoryServicePort`ã¨ã„ã†å¥‘ç´„æ›¸ã«ã€Œç½²åã€ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã“ã®ã‚¯ãƒ©ã‚¹ãŒ`check_stock`ã¨`reduce_stock`ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å¿…ãšå®Ÿè£…ã™ã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚

`__init__(self, inventory_service: InventoryService)`: å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®æ³¨å…¥
ã“ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã¯ã€è‡ªèº«ã§å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆ`InventoryService`ï¼‰ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã«ã€å¤–éƒ¨ã‹ã‚‰**å®Œæˆå“ã§ã‚ã‚‹`InventoryService`ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ³¨å…¥ï¼ˆDIï¼‰**ã•ã‚Œã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã¨å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®çµåˆã‚‚ç–ã«ä¿ãŸã‚Œã€ãƒ†ã‚¹ãƒˆæ™‚ã«ã¯å½ç‰©ã®`InventoryService`ã«å·®ã—æ›¿ãˆã‚‹ã“ã¨ã‚‚å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

`check_stock(...)` ã¨ `reduce_stock(...)`: å‡¦ç†ã®å§”è­²
ã“ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ä»•äº‹ã¯éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚Use Caseã‹ã‚‰å—ã‘å–ã£ãŸè¦æ±‚ï¼ˆ`check_stock`ã®å‘¼ã³å‡ºã—ï¼‰ã‚’ã€å†…éƒ¨ã§ä¿æŒã—ã¦ã„ã‚‹**æœ¬ç‰©ã®`inventory_service`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã€ãã®ã¾ã¾æ¨ªæµã—ï¼ˆå§”è­²ï¼šDelegateï¼‰**ã—ã¦ã„ã‚‹ã ã‘ã§ã™ã€‚

ã‚‚ã—ã€å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰åãŒæˆ‘ã€…ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ç•°ãªã£ã¦ã„ãŸå ´åˆï¼ˆä¾‹ï¼šå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ãŒ`decrease_stock`ã¨ã„ã†åå‰ã ã£ãŸå ´åˆï¼‰ã€ã“ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãŒãã®åå‰ã®é•ã„ã‚’å¸åã—ã€ç¿»è¨³ã™ã‚‹å½¹å‰²ã‚’æ‹…ã„ã¾ã™ã€‚

### 3. ã“ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é‰„å‰‡ï¼ˆå†ç¢ºèªï¼‰

1. å¥‘ç´„æ›¸ã‚’å¿…ãšå±¥è¡Œã™ã‚‹: Use Casesãƒ¬ã‚¤ãƒ¤ãƒ¼ã§å®šç¾©ã•ã‚ŒãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å¿…ãšå®Ÿè£…ã—ã¾ã™ã€‚

2. ä¾å­˜ã®çŸ¢å°ã¯å¿…ãšå†…å´ã‚’å‘ã: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€å†…å´ã®`use_cases/interfaces.py`ã¨ã€å¤–éƒ¨ã®`external_services/inventory_service.py`ã«ä¾å­˜ã—ã¾ã™ã€‚ã—ã‹ã—ã€è‡ªèº«ã®å­˜åœ¨ã‚’å†…å´ã®Use Caseã«çŸ¥ã‚‰ã›ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

3. ç¿»è¨³è€…ãƒ»å§”è­²è€…ã§ã‚ã‚Œ: è‡ªèº«ã®è²¬å‹™ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å¤‰æ›ã¨å‡¦ç†ã®å§”è­²ã«å¾¹ã—ã¾ã™ã€‚ã“ã“ã«ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ›¸ã„ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚

---
### interface_adapters/inventory_service_adapter.py

``` Python
# ä¾å­˜æ€§ã®ãƒ«ãƒ¼ãƒ«:
# ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯Interface Adaptersãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å±ã—ã¾ã™ã€‚
# å†…å´ã®use_cases.interfacesã¨ã€å¤–éƒ¨ã®external_servicesã«ä¾å­˜ã—ã¾ã™ã€‚

from use_cases.interfaces import InventoryServicePort
from external_services.inventory_service import InventoryService

class InventoryServiceAdapter(InventoryServicePort):
    """
    ã€Interface Adaptersãƒ¬ã‚¤ãƒ¤ãƒ¼ / Adapterã€‘
    InventoryServicePortã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å…·ä½“çš„ãªå®Ÿè£…ã‚¯ãƒ©ã‚¹ã€‚
    
    ã“ã®ã‚¯ãƒ©ã‚¹ã®è²¬å‹™ã¯ã€æˆ‘ã€…ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…éƒ¨ã®è¦æ±‚ï¼ˆãƒãƒ¼ãƒˆã¸ã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ï¼‰ã‚’ã€
    å¤–éƒ¨ã®åœ¨åº«ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹ã®APIå‘¼ã³å‡ºã—ã¸ã¨ã€Œå¤‰æ›ã€ã—ã€ã€Œå§”è­²ã€ã™ã‚‹ã“ã¨ã€‚
    """
    def __init__(self, inventory_service: InventoryService):
        # å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§å—ã‘å–ã‚‹ï¼ˆä¾å­˜æ€§ã®æ³¨å…¥ï¼‰
        self.inventory_service = inventory_service

    def check_stock(self, product_id: str, quantity: int) -> bool:
        """
        Use Caseã‹ã‚‰ã®åœ¨åº«ç¢ºèªè¦æ±‚ã‚’ã€å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®åŒåãƒ¡ã‚½ãƒƒãƒ‰ã«å§”è­²ã™ã‚‹ã€‚
        """
        print(f"ğŸ”Œ ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼: åœ¨åº«ç¢ºèªè¦æ±‚ã‚’å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«è»¢é€ã—ã¾ã™ã€‚(å•†å“ID: {product_id})")
        return self.inventory_service.check_stock(product_id, quantity)

    def reduce_stock(self, product_id: str, quantity: int):
        """
        Use Caseã‹ã‚‰ã®åœ¨åº«å‰Šæ¸›è¦æ±‚ã‚’ã€å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®åŒåãƒ¡ã‚½ãƒƒãƒ‰ã«å§”è­²ã™ã‚‹ã€‚
        """
        print(f"ğŸ”Œ ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼: åœ¨åº«å‰Šæ¸›è¦æ±‚ã‚’å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«è»¢é€ã—ã¾ã™ã€‚(å•†å“ID: {product_id})")
        self.inventory_service.reduce_stock(product_id, quantity)
```

```
# CA-07

```markdown
## クリーンアーキテクチャのまとめ

### クリーンアーキテクチャによる改善点
このリファクタリングにより、私たちのプログラムは真に堅牢で柔軟な構造を手に入れました。

1. フレームワークからの独立:<br>
`domain`と`use_cases`のコードは、`main.py`がどうなっているか、Webフレームワークが何かを一切知りません。

2. テストの容易性:<br>
`ProcessOrderUseCase`は、本物のデータベースなしで簡単に単体テストできます。`InMemoryProductRepository`のようなテスト用のリポジトリ（モック）を渡すだけで済みます。

3. 技術的詳細の交換可能性:<br>
もし将来、データをインメモリDBからMySQLに変更したくなった場合、`InMemoryProductRepository`を`MySqlProductRepository`に置き換えて、`main.py`の1行を書き換えるだけで済みます。ビジネスロジックのコードには一切触る必要がありません。

---
### 次への課題 - クリーンアーキテクチャの限界？

クリーンアーキテクチャは、アプリケーションの技術的な構造を非常にクリーンに保つための強力な設計図です。

しかし、この「金庫室」の中に保管すべき「宝物」、つまりビジネスロジックそのものが、もし複雑で、矛盾をはらみ、分かりにくいものであったらどうでしょう？

- 「プレミアム会員の注文」と「通常会員の注文」では、在庫引き当てのルールが違う。

- 「予約注文」と「通常注文」では、価格計算のタイミングが違う。

このような複雑なビジネスルールを、`use_cases`や`domain`の中にどうやって整理し、ビジネスの専門家が話す言葉とコードをどうやって一致させるのか？
クリーンアーキテクチャは、その**「方法論」**については、実はあまり多くを語ってくれません。

この、より本質的な「ビジネスの複雑さとどう向き合うか」という課題を解決するため、次のステップである**ドメイン駆動設計（DDD）**が必要となるのです。

```
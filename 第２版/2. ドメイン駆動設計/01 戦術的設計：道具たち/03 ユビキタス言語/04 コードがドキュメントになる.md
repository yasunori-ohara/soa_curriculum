## コードがドキュメントになる

「コードがドキュメントになる」という点は、DDDがもたらす効果の中でも特に開発者の日々の仕事を楽にする、非常に重要な側面です。深掘りしていきましょう。

-----

おっしゃる通り、優れたプログラマーは、意識的か無意識的かにかかわらず、変数名やメソッド名を分かりやすくすることで、自然と「コードをドキュメント化」しようと努力します。

**ユビキタス言語**は、その個人の素晴らしい努力を、**チーム全体の体系的なプラクティス**へと昇華させるための強力な道具です。

### レベル1：優れた個人の工夫

まず、DDDを知らなくても優れたプログラマーが書くコードです。

  * **悪い例**: `if (u.type == 1 && i.cat == 3)`
  * **良い例**: `if (user.is_premium == True and item.category == 'Book')`

`u`を`user`に、`1`を`is_premium`にするなど、意味が分かるように命名します。これだけでもコードの可読性は大きく向上します。しかし、ここには\*\*「個人の解釈」\*\*が入る余地があります。

  * Aさんは「予約キャンセル」を `cancel_booking` と名付けた
  * Bさんは同じ機能を `remove_reservation` と名付けた

どちらも「分かりやすい」ですが、チーム全体で見ると**用語が統一されておらず**、混乱の元になります。

-----

### レベル2：ユビキタス言語によるチームの進化

ユビキタス言語は、この「個人の解釈」を排除し、\*\*チーム全員が従うべき「唯一の正しい言葉」\*\*を定義します。

> **予約 (Reservation)**: 特定の客室タイプを確保する**契約**。
> (チームの辞書で、"Booking"ではなく"Reservation"を使うと合意)

この辞書があることで、先ほどの命名の揺れは発生しません。全員が`cancel_reservation`という名前に統一します。

これは単なる命名規則ではありません。**ビジネスの概念そのものをコードに反映させる**という、より深いレベルでの一致を目指します。

-----

### レベル3：ビジネスルールがそのままコードになる実践例

この効果が最も顕著に表れるのが、複雑なビジネスルールを実装する場面です。

#### シナリオ

ホテルのルール：「**プレミアム会員**の**顧客**が、**通常客室**を**早期割引期間**に**予約**した場合、**宿泊料金**から10%割引を適用する」

#### 👎 ユビキタス言語がない場合のコード

このコードを理解するには、コメントや仕様書を読んで、「`user_rank`の`1`って何だっけ？」「`room_class`の`'STD'`って何？」と**頭の中で翻訳する**必要があります。コード自体は何も語ってくれません。

```python
# user_rank: 1=プレミアム, 2=一般
# room_class: 'STD'=通常, 'DX'=デラックス
def calculate_price(user_rank: int, room_class: str, is_early: bool, base_price: float) -> float:
    
    # プレミアム会員の早期割引
    if user_rank == 1 and room_class == 'STD' and is_early:
        # 10%割引
        return base_price * 0.9
    
    return base_price
```

#### 👍 ユビキタス言語が徹底されたコード

ユビキタス言語の用語（`Customer`, `RoomType`, `Reservation`, `Rate`など）が、そのままクラスやメソッド名になっています。

**このコードは、ビジネスルールを知らない人が読んでも、何をしているかほぼ理解できます。** これが「コードがドキュメントになる」の真髄です。

```python
# ユビキタス言語のクラスを直接利用する
def calculate_final_rate(customer: Customer, room_type: RoomType, reservation: Reservation) -> Rate:

    # if文がビジネスルールの文章そのものになっている
    if customer.is_premium_member() and \
       room_type.is_standard() and \
       reservation.is_early_bird():
        
        return room_type.base_rate.apply_discount(percent=10)

    return room_type.base_rate
```

### まとめ

ユビキタス言語は、単なる「分かりやすい命名」という個人の工夫から一歩進んで、
**チームで合意したビジネスの言葉を、そのままコードの構造に反映させる**ための体系的なアプローチです。

これにより、コードは「プログラマーにしか読めない命令書」から、「**ビジネスに関わる誰もが（ある程度）読解可能で、かつ実行可能な、最も正確な仕様書**」へと進化するのです。
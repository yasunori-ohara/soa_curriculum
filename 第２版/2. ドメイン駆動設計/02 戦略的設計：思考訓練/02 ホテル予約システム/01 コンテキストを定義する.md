# 実践 - ホテル予約システムの地図を描く

この章では、これまで学んだ「DDDの道具たち」を使い、具体的な例題である「**簡単なホテルの予約システム**」の設計を行っていきます。

目的は、コードを書くことではなく、システムの**全体像（地図）**を明らかにすることです。

承知いたしました。確かに、結果から入るのではなく、そこに至る思考プロセスを一緒に辿ることが、この訓練の目的ですね。失礼いたしました。

では、まっさらな状態から始めましょう。

### ステップ1：システムの「言葉」を集める（ユビキタス言語）

私たちは今、ホテル予約システムの開発を任されたチームです。最初のミーティングには、開発者である我々と、ホテルの予約担当者（ドメイン専門家）が参加しています。

まず我々がやるべきことは、予約担当者が普段の業務で**何気なく使っている「言葉」**に耳を傾け、それをリストアップすることです。

> **予約担当者**: 「お客様から電話があって、『来週末の**宿泊期間**で**客室タイプ**がツインの**予約**をお願いします』と。その期間の**料金**を確認して、**顧客**情報を登録しました。**支払い**は当日だそうです。」

この短い会話だけでも、たくさんの重要な言葉が隠されています。これらを一つずつ拾い集めていきましょう。

**📝 ユビキタス言語 候補リスト**
* 予約 (Reservation)
* 宿泊期間 (Stay Period)
* 客室タイプ (Room Type)
* 料金 (Rate)
* 顧客 (Customer)
* 宿泊客 (Guest)
* 支払い (Payment)

---
### ステップ2：「言葉のグループ」を見つけ出す

次に、集めた言葉のリストを眺め、「**どの言葉とどの言葉が、いつも一緒に使われるか？**」という基準で、言葉のグループ（＝**会話の文脈**）を探していきます。

#### 考察1：「予約を取る」という会話
お客さんから予約の電話がかかってきた場面を想像します。この会話の主な目的は「予約を成立させること」です。

* まず「**宿泊期間**」と「**客室タイプ**」を聞きます。
* それに基づいて「**料金**」を計算し、伝えます。
* すべて合意できたら、最終的に「**予約**」が成立します。

→ ここから、`予約`, `宿泊期間`, `客室タイプ`, `料金` は、「予約を取る」という一つの文脈の中で非常に強く結びついていることが分かります。これを**グループA**としましょう。

#### 考察2：「顧客を管理する」という会話
次に、マーケティング担当者が「お得意様にキャンペーンメールを送りたい」と考えている場面を想像します。

* まず「**顧客**」のリストが必要です。
* その顧客が、過去にどのような「**宿泊客**」として、いつ宿泊したかの履歴も重要になります。

→ ここから、`顧客`, `宿泊客` は、予約そのものとは少し違う、「人を管理する」という文脈で使われる言葉だと分かります。これを**グループB**としましょう。

#### 考察3：「お金を扱う」という会話
経理担当者が、月末の締め処理をしている場面を想像します。

* 彼らが気にするのは、各予約に対する「**支払い**」が正しく行われたか、ということです。
* 支払いがいつ行われ、いくらだったか、という情報が重要です。

→ ここから、`支払い`は、予約の詳細や顧客情報とは独立した、「お金」という専門的な文脈で使われる言葉だと分かります。これを**グループC**としましょう。

---
### ステップ3：グループに名前を付けて「コンテキスト」を定義する

この思考プロセスを経て、私たちはホテル予約システムという一つの大きなドメインの中に、**3つの異なる会話の文脈**が存在することを発見しました。

この発見したグループこそが、システムの分割単位である**境界づけられたコンテキスト**の有力な候補となります。

* **グループA** → **予約コンテキスト**
* **グループB** → **顧客管理コンテキスト**
* **グループC** → **決済コンテキスト**

このように、ただ言葉をグループ分けするという単純な作業から、システムの適切な分割案を導き出すことができました。

## 🖼️ ユビキタス言語

戦術的設計で設計した部品を元に、今度は監視用HDDレコーダーの**戦略的設計**、つまりシステム全体の「地図」を描く思考訓練を始めましょう。

このシステムの戦略的設計では、まずユビキ-タス言語を整理し、システムの関心事を分割します。その結果、主に**「録画」**、**「再生」**、**「設定」**、**「ライブ表示」**という4つの独立した**境界づ-けられたコンテキスト**を発見し、それらの関係性を定義していくことになります。

***

### ステップ1：言葉を集める（ユビキタス言語）

まず、仕様書からこのドメインで使われる重要な言葉をリストアップします。

**📝 ユビキタス言語 候補リスト**
* カメラ (Camera)
* 録画セグメント (Recording Segment)
* ループ録画 (Loop Recording)
* 通常録画 / アラーム録画 / 緊急録画
* 保護領域 (Protected Area)
* 再生 (Playback), 早送り, 巻き戻し
* 検索 (Search)
* 画面分割 (Screen Split)
* 設定 (Configuration), 解像度, 記録枚数, スケジュール

---
### ステップ2：「言葉のグループ」からコンテキストを発見する

次に、これらの言葉がどのような会話の文脈で使われるかを考え、グループ分けします。

* **グループA（録画の文脈）**:
    「**通常録画**」や「**緊急録画**」の話をするときは、必ず「**録画セグメント**」をどう扱うか、HDDが満杯なら「**ループ録画**」をどうするか、「**保護領域**」の残量は、といった話がセットになります。これは、**映像をディスクに書き込む**という非常に専門的で複雑な関心事のまとまりです。

* **グループB（再生の文脈）**:
    「**再生**」や「**検索**」の話をするときは、「**録画セグメント**」を「日時」や「アラーム種別」で探し出し、「早送り」や「巻き戻し」をするといった話になります。これは、**ディスクから映像を読み出す**という、録画とは逆の関心事です。

* **グループC（設定の文脈）**:
    「カメラの**解像度**」や「タイマーの**スケジュール**」、「**保護領域**の割合」といった話は、録画や再生とは独立した、システムの**動作を構成（コンフィグ）する**ための会話です。

* **グループD（ライブ表示の文脈）**:
    「**画面分割**を4分割にする」「3番カメラの映像を表示する」といった話は、リアルタイムの映像をモニターに表示することに特化しており、録画データとは直接関係ありません。

---
### ステップ3：コンテキストを定義し、検証する

このグループ分けから、4つのコンテキスト候補が浮かび上がります。

* **グループA → 録画コンテキスト (Recording Context)**
    * **責務**: 映像データをディスクに書き込み、ループ録画や保護領域のルールを管理する。

* **グループB → 再生コンテキスト (Playback Context)**
    * **責務**: 録画済みの映像データを検索し、再生をコントロールする。

* **グループC → 設定コンテキスト (Configuration Context)**
    * **責務**: システム全体の動作設定（カメラ、ストレージなど）を管理する。

* **グループD → ライブ表示コンテキスト (Display Context)**
    * **責務**: カメラからのライブ映像をモニターに表示する方法を管理する。

これらの責務は明確に分離されており、それぞれが「本物」のコンテキストとして成立しそうです。

---
### ステップ4：コンテキストマップで関係性を定義する

最後に、これらのコンテキストがどう連携するかを考えます。

* **設定コンテキスト**は、他のすべてのコンテキストの動作に影響を与える、最も**上流**に位置します。
* **録画コンテキスト**が生成した録画データ（`RecordingSegment`）を、**再生コンテキスト**が利用します。したがって、録画が**上流**、再生が**下流**です。

**影響の流れ**
* **設定コンテキスト (上流)** → **録画コンテキスト (下流)**
* **設定コンテキスト (上流)** → **ライブ表示コンテキスト (下流)**
* **録画コンテキスト (上流)** → **再生コンテキスト (下流)**

この地図を描くことで、例えば「設定の変更は、録画と表示の両方に影響を与える可能性がある」といった、システム全体の構造的な関係性を明確に把握することができます。
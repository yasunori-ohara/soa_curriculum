## API設計の基礎

### ✨ APIという「対話の窓口」

まず、API（Application Programming Interface）**とは、プログラム同士が対話するための**「窓口」だと考えてください。サービス（プログラム）が提供する機能を、外部のプログラムが利用するための接点となります。

### ✨ OpenAPI：対話のルールを記した「設計図」

**OpenAPI**は、このAPIという窓口での対話ルールを記述するための世界標準のルール（仕様）です。このルールに従って書かれたYAMLまたはJSON形式のファイルは、**人間とコンピュータの両方が正確に理解できる**APIの「設計図」となります。

人間にとっては、構造化されたドキュメントとしてAPIの全体像を把握でき、コンピュータにとっては、このファイルを読み込むことでAPIの呼び出し方を理解し、様々な作業を自動化できます。

#### **OpenAPI (YAML) の具体例**

以下は、「ユーザー情報をIDで取得するAPI」の設計図をYAML形式で記述した例です。コメントで各セクションの役割を解説します。

```yaml
# ----------------------------------------------------------------------
# APIの「エンドポイント（操作の窓口）」を定義するセクションです。
# どのようなURLで、どのような操作ができるかを記述します。
# ----------------------------------------------------------------------
paths:
  # 「/users/{userId}」というURLパスに対する定義
  /users/{userId}:

    # ------------------------------------------------------------------
    # このパスに対して「GET」メソッドでアクセスした場合の操作を定義します。
    # HTTPのGETメソッドは、主にデータを「取得」するために使われます。
    # ------------------------------------------------------------------
    get:
      summary: "ユーザー情報をIDで取得する" # この操作の簡単な説明（人間向け）

      # ----------------------------------------------------------------
      # この操作に必要な「パラメータ（入力）」を定義します。
      # APIを呼び出す際に、クライアントがサービスに渡す情報です。
      # ----------------------------------------------------------------
      parameters:
        - name: userId   # パラメータ名
          in: path     # パラメータがURLのパスに含まれることを示す
          required: true # このパラメータは必須
          schema:
            type: string # パラメータのデータ型は文字列

      # ----------------------------------------------------------------
      # パラメータを送信した結果としての「レスポンス（出力）」を定義します。
      # 操作が成功した場合や失敗した場合に、サービスがクライアントに
      # 何を返すかを記述します。
      # ----------------------------------------------------------------
      responses:
        # HTTPステータスコードが「200 OK」（成功）の場合のレスポンス
        '200':
          description: "成功" # レスポンスの説明（人間向け）
          content:
            application/json: # レスポンスの形式はJSON
              schema:
                # 詳細なデータ構造は後述の「components」で定義した
                # 「UserResponse」という名前の設計図を参照します。
                $ref: '#/components/schemas/UserResponse'

# ----------------------------------------------------------------------
# API全体で再利用可能な「部品（データ構造など）」を定義するセクションです。
# ここで定義したものを paths から参照することで、記述の重複をなくします。
# ----------------------------------------------------------------------
components:
  schemas:
    # 「UserResponse」という名前のデータ構造の設計図
    UserResponse:
      type: object # データ型はオブジェクト
      properties:  # オブジェクトが持つプロパティ
        id:
          type: string
        name:
          type: string
```

### ✨ OpenAPIを利用する目的

このような「設計図」を用意する主な目的は3つです。

1.  **コミュニケーションの円滑化**: 「APIの仕様」という曖昧さをなくし、開発者間の共通認識を作ります。
2.  **自動化の促進**: 設計図がコンピュータにも読めるため、ドキュメントやコード、テストなどを自動生成できます。
3.  **並行開発の実現**: 設計図さえあれば、APIを「作る側」と「使う側」が同時に開発を始められます。

-----

> **補足：REST APIとの関係**
>
> APIで対話するには、何らかのルールや**作法**が必要です。現在、最も広く使われている作法が\*\*REST（Representational State Transfer）\*\*です。
>
> RESTとは、
>
>   * \*\*URLで「何を」\*\*示す (例: `/users/123`はID123のユーザー)
>   * \*\*HTTPメソッドで「どうしたいか」\*\*示す (例: `GET`は取得、`POST`は新規作成)
>
> といった原則に基づく、シンプルで分かりやすい作法です。
>
> OpenAPIは、この**RESTという作法に則って作られたAPIの仕様を記述するために、最も一般的に利用されています**。


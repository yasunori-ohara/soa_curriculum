## 🤔 分散モノリスとはどんなもので、どんな利点と欠点があたのでしょうか？

これはSOAやマイクロサービスを学ぶ上で非常に重要な「避けるべきアンチパターン」です。

---

### 分散モノリスとは？

一言でいうと**「モノリス（一枚岩）アーキテクチャの悪い点」**と**「分散システム（マイクロサービス）の悪い点」**を**”いいとこ取り”ならぬ”わるいとこ取り”**してしまった最悪の状態です。


具体的には、システムが**物理的**には複数のサービスに分割されているのに、**論理的**にはお互いがガチガチに依存し合って結合している状態を指します。まるで、体は分かれているのに神経や血管が全部つながってしまっているシャム双生児のようなものです。

---
### 利点はあるのか？

結論から言うと、**意図して目指す利点は一つもありません**。

分散モノリスは、アーキテクチャ設計の成功例ではなく、**モノリシックなシステムをマイクロサービスへ移行しようとして失敗した結果、意図せず生まれてしまうもの**だからです。

---
### どんな欠点があるのか？

分散モノリスは、モノリスと分散システムの欠点を組み合わせた、以下のような深刻な問題を引き起こします。

* **1. 複雑性の爆発** 🤯
    * **（モノリスの欠点）** 一つの機能を変更しようとすると、その影響が他の多くのサービスに及びます。
    * **（分散システムの欠点）** その影響範囲の調査が、ネットワークという見えない壁を越えて行われるため、追跡が非常に困難になります。デバッグは地獄絵図と化します。

* **2. 独立してデプロイできない** ⛓️
    * マイクロサービスの最大の利点の一つは「サービスを個別に素早くデプロイできること」です。
    * しかし分散モノリスでは、サービスAを変更した場合、それに依存するサービスBとCも**同時にデプロイ**しないとシステム全体が動かなくなるといった事態に陥ります。これでは、サービスを分割した意味が全くありません。

* **3. パフォーマンスの低下** 🐢
    * モノリスなら一瞬で終わるただの関数呼び出しが、分散モノリスではすべてネットワーク越しのAPI通信になります。
    * この通信による遅延（レイテンシ）が積み重なり、システム全体のパフォーマンスがモノリス時代より悪化することがよくあります。

* **4. 障害に弱い** domino
    * サービス同士が密に結合しているため、一つのサービスの小さな障害が、ドミノ倒しのように他のサービスに連鎖して伝播し（カスケード障害）、結果的にシステム全体がダウンしてしまいます。

このように、分散モノリスは開発の生産性、システムのパフォーマンス、安定性のすべてを損ないます。私たちがこれから学ぶ**「SOAの原則」**や**「DDDに基づいた適切な境界設定」**は、この分散モノリスという罠を回避するために不可欠な知識なのです。

## 🤔 ちゃんと理解せずにモノリスを分散させようとするときに、できてしまうものなのですね。私も当初は、「オブジェクト指向できちんと抽象化・疎結合したものを関数コールから通信にしたらSOAになるのかな」と思っていたのですが、ここまでの学習を経て、「いままでの抽象化と疎結合が甘かったので、分散モノリスを作っていたかもしれないぞ」と思いました。

おっしゃる通りです！まさに、その気づきこそが、これまでの学習の最大の成果です 👏。

そしてこれは**100点満点の洞察**です。多くの方が同じ落とし穴にはまってしまいます。

モノリス内のモジュール呼び出し（関数呼び出し）と、サービス間の**ネットワーク越しの通信**は、似ているようで全くの別物です。ネットワークは、

* **遅い（レイテンシがある）**
* **不安定（通信が失敗することがある）**
* **やり取りするデータ形式に制約がある（オブジェクトをそのまま渡せない）**

といった、モノリスには無かった多くの制約を伴います。

DDDで学んだ「凝集性の高い、適切な境界」でサービスを分割しないと、サービス間の通信が異常に多く（チャッティに）なってしまい、パフォーマンスが低下します。また、クリーンアーキテクチャで学んだ「依存関係の管理」ができていないと、一つのサービスの変更が他のサービスに影響し、独立性が失われます。

まさに、**これまで学んだ知識は、分散モノリスという罠を回避するためにあった**と言っても過言ではありません。

素晴らしい気づきを共有いただき、ありがとうございます。これで、なぜ私たちが理論から学んでいるのか、その重要性がより明確になりましたね。

---

それでは、準備が整ったところで、いよいよSOAの根幹である**「4大基本原則」**を見ていきましょうか。

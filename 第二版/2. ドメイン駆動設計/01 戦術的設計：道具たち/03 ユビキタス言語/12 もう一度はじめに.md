## もう一度、はじめにを別角度で

## 目的：複雑なシステムをどう分割するか

私たちのゴールは、ホテル予約システムという複雑な対象を、**関心事ごとにクリーンで独立した複数のパーツに分割する**ことです。これができれば、各パーツを個別に開発・修正でき、非常に見通しの良いシステムになります。

しかし、この「分割の境界線」をいきなり見つけようとするのは非常に困難です。

## 手段：言語のグループ分けで「切れ目」を見つける

そこで、この難しい問題を解くための強力な手段として、**ユビキタス言語**を利用します。ここでのユビキタス言語の役割は、**システムの自然な「切れ目」を見つけ出すための分析材料**です。

### ステップ１：分析の材料となる言葉を集める（ユビキタス言語の定義）

まず、ホテルの業務で使われる言葉を、意味の解釈は後回しにして、とにかく集めます。

**📝 分析材料リスト**
* 予約 (Reservation)
* 宿泊期間 (Stay Period)
* 料金 (Rate)
* 顧客 (Customer)
* 宿泊客 (Guest)
* 支払い (Payment)
* 客室タイプ (Room Type)
* 請求情報 (Invoice)
* 連絡先 (Contact Info)

---
### ステップ２：言葉をグループ分けし、「切れ目」のヒントを得る

次に、これらの言葉が「どのような会話の文脈で、どの言葉と一緒に使われるか」を基準にグループ分けします。

* **グループA（予約の文脈）**:
    * 「**予約**」の話をするとき、必ず「**宿泊期間**」と「**客室タイプ**」、そして「**料金**」の話がセットで出てくる。

* **グループB（顧客の文脈）**:
    * 「**顧客**」の情報を管理するとき、「**宿泊客**」としての履歴や「**連絡先**」も一緒に管理したい。

* **グループC（支払いの文脈）**:
    * 「**支払い**」処理では、「**請求情報**」やカード情報などが専門用語として使われ、予約の文脈とは少し違う会話になる。

このグループ分けこそが、システムの分割単位を決めるための**客観的なヒント**です。

---
### ステップ３：ヒントを元に、システムを分割する（境界づけられたコンテキスト）

この言語的なグループが、そのままシステムの分割単位（＝**境界づけられたコンテキスト**）の有力な候補となります。

* **グループA** → **予約コンテキスト**
* **グループB** → **顧客管理コンテキスト**
* **グループC** → **決済コンテキスト**


このアプローチの最大のメリットは、開発者の主観や勘に頼るのではなく、**ビジネスで実際に使われている「言葉」という客観的な事実に基づいて、システムの構造を決定できる**点にあります。普通の開発者にとっても、「なるほど、言葉の使われ方に注目すれば、自然な分割のヒントが得られるのか」と、実践する価値を感じられるはずです。

---
### 補足：副次的なメリットとしての「共通辞書」

そして、この分割作業の副産物として、ステップ１で作成した言葉のリストが**チームの共通辞書**としての役割も果たします。
システムの構造が言葉の構造を反映しているため、チーム内の会話で使う言葉とコード上のクラス名などが一致し、結果的にコミュニケーションがスムーズになる、という二次的なメリットも得られます。
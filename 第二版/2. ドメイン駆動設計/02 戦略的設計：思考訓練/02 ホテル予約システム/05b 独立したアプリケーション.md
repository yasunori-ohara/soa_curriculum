## 🤔 ホテル予約システムを３つの独立したアプリケーションにできるということを、もう少し詳しく教えてください。

これは、**各コンテキストを、それぞれが完全に独立したプログラム（Webサーバーなど）として開発・実行する**ということです。これらのアプリケーション同士は、関数呼び出しではなく、**ネットワーク経由のAPI呼び出し**で連携します。

-----

### 1つの大きなアプリケーション vs. 3つの小さなアプリケーション

この2つのアプローチの違いを見ていきましょう。

#### 従来の考え方：1つの大きなアプリケーション（モノリス）

これは、私たちがこれまで見てきた「モジュラーモノリス」の考え方です。
`booking`, `customer`, `payment` というモジュール（部署）はありますが、それらはすべて一つのビル（アプリケーション）の中に入っています。

**`hotel_application/`** (一つのプログラム)

```
├── booking/
├── customer/
├── payment/
└── main.py
```

  * **長所**: 部署間の移動（モジュール間の関数呼び出し）が簡単で速い。
  * **短所**: ビルの一箇所で火事（バグ）が起きると、ビル全体が機能停止する。ビルを改築（デプロイ）するときは、全館一斉に休業する必要がある。

-----

### 新しい考え方：3つの独立したアプリケーション（マイクロサービス）

戦略的設計で分割したコンテキストを、それぞれ\*\*別々のビル（独立したアプリケーション）\*\*として建てます。

**`booking_service/`** (プログラム1)

```
└── main.py
```

**`customer_service/`** (プログラム2)

```
└── main.py
```

**`payment_service/`** (プログラム3)

```
└── main.py
```

これらのビル（アプリケーション）は、それぞれが独自のWebサーバーを持ち、独立して動いています。

#### どうやって連携するのか？：API通信

部署間の移動が「廊下を歩く」のとは違い、ビル間の移動は「電話をかける」「手紙を送る」といった**外部との通信**が必要になります。これが**API (Application Programming Interface)** です。

**予約から支払いまでの流れ（例）**

1.  ユーザーがブラウザから**予約サービス**に「予約したい」というリクエストを送ります。
2.  **予約サービス**は、料金を計算し、予約を仮確保します。
3.  次に、予約サービスは**決済サービス**に対して、「顧客ID『CUS-123』に15,000円を請求してください」という**APIリクエスト**（HTTPリクエストなど）をネットワーク経由で送ります。
4.  **決済サービス**は、そのリクエストを受け取って独立して決済処理を行い、「成功しました」という結果を予約サービスに返します。
5.  決済成功を受けて、予約サービスは予約を確定します。

-----

### なぜ、わざわざ分割するのか？

この一見すると複雑な構造には、それを上回る大きなメリットがあります。

  * **独立したデプロイ**:
    決済サービスのチームは、予約サービスとは全く関係なく、自分たちのプログラムだけをいつでも更新できます。金曜の夜に決済のバグを修正しても、予約サービスを止める必要はありません。

  * **技術選択の自由**:
    高いセキュリティが求められる**決済サービス**は堅牢なJavaで、UIとの連携が多い**予約サービス**は開発スピードの速いPythonで、といったように、それぞれの仕事に最適な道具（プログラミング言語やデータベース）を選ぶことができます。

  * **障害への耐性**:
    もし**顧客サービス**（過去の履歴表示など）がダウンしても、**予約サービス**と**決済サービス**が生きていれば、新規の予約は受け付けることができるかもしれません。一つの障害がシステム全体を停止させるリスクを減らせます。

このように、コンテキストごとにアプリケーションを物理的に分割することは、大規模で複雑なシステムを、変化に強く、堅牢に育てていくための強力な戦略なのです。